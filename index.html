<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sistema de Gest√£o Financeira - Advocacia</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
	<style>
		/* [SE√á√ÉO 1: Estilos Gerais] */
		body {
			font-family: 'Inter', sans-serif;
			position: relative;
			background-color: #0f172a;
			color: #d1d5db;
			/* [REVOLU√á√ÉO] Trava o scroll do body, o main content que vai rolar */
			overflow-y: hidden; 
		}
		body::after {
			content: '';
			position: fixed;
			z-index: -2; /* Atr√°s de tudo */
			top: 0; left: 0; right: 0; bottom: 0;
			background-image: url('https://i.postimg.cc/x81V8QJg/Imagem-do-Whats-App-de-2025-10-27-a-s-09-49-28-f966cd35.jpg');
			background-repeat: no-repeat;
			background-size: cover;
			background-position: center center;
			opacity: 0.12;
		}
		.modal-backdrop { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 9000; }
		
		.modal { 
			display: none; 
			position: fixed; 
			top: 50%; left: 50%; 
			transform: translate(-50%, -50%); 
			z-index: 9001; 
			max-height: 90vh; 
			border: 1px solid #374151;
			box-shadow: 0 10px 30px 0 rgba(0, 0, 0, 0.4);
		}
		.modal-body {
			overflow-y: auto;
			max-height: 70vh;
		}

		.kanban-column { min-width: 320px; }
		.kanban-content { max-height: 60vh; overflow-y: auto; padding-right: 8px; }
		::-webkit-scrollbar { width: 8px; }
		::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 10px; }
		::-webkit-scrollbar-thumb:hover { background: #6b7280; }
		.service-tag { display: inline-flex; justify-content: space-between; align-items: center; background-color: #374151; color: #d1d5db; padding: 4px 10px; border-radius: 12px; font-size: 14px; margin-right: 4px; margin-bottom: 4px; width: 100%; }
		.service-tag-small { display: inline-block; background-color: #374151; color: #9ca3af; padding: 2px 8px; border-radius: 9999px; font-size: 12px; margin-right: 4px; margin-bottom: 4px; }
		.service-tag .remove-tag { margin-left: 8px; cursor: pointer; font-weight: bold; }
		
		.nav-tab { }
		.nav-tab-icon { }
		
		.sidebar-nav-item {
			display: flex;
			align-items: center;
			gap: 0.75rem; /* 12px */
			padding: 0.75rem 1rem; /* 12px 16px */
			border-radius: 0.5rem; /* 8px */
			color: #d1d5db; /* text-gray-300 */
			transition: all 0.2s ease-in-out;
			cursor: pointer;
		}
		.sidebar-nav-item:hover {
			background-color: #4338ca; /* indigo-700 */
			color: #ffffff;
		}
		.sidebar-nav-item.active {
			background-color: #4f46e5; /* indigo-600 */
			color: #ffffff;
			box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.5); /* Sombra/brilho √≠ndigo */
		}
		
		.mobile-nav-item {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			flex: 1;
			padding: 0.75rem 0.5rem; /* 12px 8px */
			color: #9ca3af; /* text-gray-400 */
			transition: all 0.2s ease-in-out;
		}
		.mobile-nav-item:hover {
			color: #6366f1; /* text-indigo-500 */
		}
		.mobile-nav-item.active {
			color: #6366f1; /* text-indigo-500 */
			background-color: rgba(79, 70, 229, 0.1); /* indigo-600/10 */
		}

		.progress-bar-bg { background-color: #374151; border-radius: 9999px; overflow: hidden; }
		.progress-bar { height: 100%; border-radius: 9999px; transition: width 0.5s ease-in-out; }
		
		.dark-card { 
			background-color: #1f2937;
		}
		
		.header-with-logo { }
		.header-user-block { }
		.header-logo { }
		
		.sort-button, .filter-button { background-color: #374151; border: 1px solid #4b5563; color: #9ca3af; padding: 4px 10px; border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.2s; }
		.sort-button:hover, .filter-button:hover { background-color: #4b5563; color: white; }
		.sort-button.active, .filter-button.active { background-color: #4f46e5; border-color: #4f46e5; color: white; }
		
		.filter-select { 
			background-color: #1f2937;
			border: 1px solid #4b5563; 
			color: #9ca3af; 
			padding: 8px 12px; 
			border-radius: 6px; 
			font-size: 14px;
			transition: all 0.2s ease-in-out;
		}
		.filter-select:focus {
			border-color: #6366f1;
			box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
			outline: none;
		}
		.filter-select:disabled { background-color: #4b5563; opacity: 0.7; cursor: not-allowed; }
		
		#loading-overlay { 
			position: fixed; 
			top: 0; left: 0; 
			width: 100%; height: 100%; 
			background-color: rgba(17, 24, 39, 0.9); 
			display: flex; 
			justify-content: center; 
			align-items: center; 
			z-index: 10000; 
			color: white; 
			font-size: 1.2rem; 
			transition: opacity 0.3s; 
		}
		#app-container { display: none; }
		
		.admin-only { display: none; }
		body.is-admin .admin-only { display: block; }
		body.is-admin .flex.admin-only { display: flex; }
		body:not(.is-admin) .non-admin-hidden { display: none; }
		
		.login-modal { }

		@keyframes fadeIn { from { opacity: 0; transform: translate(-50%, -60%); } to { opacity: 1; transform: translate(-50%, -50%); } }
		.notification { position: fixed; top: 20px; right: 20px; background: #10b981; color: white; padding: 12px 16px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); z-index: 11000; animation: slideIn 0.3s ease; }
		@keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
		
		@media (max-width: 768px) {
			.kanban-column { min-width: 100%; }
		}

		/* === ESTILOS DE PAGINA√á√ÉO === */
		.pagination-button {
			background-color: #374151;
			border: 1px solid #4b5563;
			color: #9ca3af;
			padding: 6px 12px;
			border-radius: 6px;
			font-size: 14px;
			cursor: pointer;
			transition: all 0.2s;
			font-weight: 500;
		}
		.pagination-button:hover:not(:disabled) {
			background-color: #4b5563;
			color: white;
		}
		.pagination-button.active {
			background-color: #4f46e5;
			border-color: #4f46e5;
			color: white;
			cursor: default;
		}
		.pagination-button:disabled {
			opacity: 0.5;
			cursor: not-allowed;
		}
		#paginationContainer span {
			padding: 6px 4px;
			font-size: 14px;
			color: #6b7280;
		}
		
		/* === ESTILOS (UX/TRANSI√á√ïES) === */
		.modal button {
			transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
		}
		.modal button:hover:not(:disabled) {
			transform: translateY(-1px);
			box-shadow: 0 4px 12px rgba(0,0,0,0.2);
		}
		
		/* === ESTILOS (NOVO LOGIN) === */
		@keyframes blob {
			0%, 100% { transform: translate(0, 0) scale(1); }
			33% { transform: translate(30px, -50px) scale(1.1); }
			66% { transform: translate(-20px, 20px) scale(0.9); }
		}
		.animate-blob {
			animation: blob 7s infinite;
		}
	</style>
</head>
<body class="text-gray-300">
	<div id="notifications"></div>

	<div id="loading-overlay">
		<i class="fas fa-spinner fa-spin mr-3"></i> A ligar...
	</div>

	<!-- [TELA DE LOGIN - SEM ALTERA√á√ïES CONFORME O PEDIDO] -->
	<div id="auth-overlay" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 relative overflow-hidden px-4">
		<div class="absolute inset-0 opacity-5">
			<div class="absolute inset-0 bg-[url('https://i.postimg.cc/x81V8QJg/Imagem-do-Whats-App-de-2025-10-27-a-s-09-49-28-f966cd35.jpg')] bg-cover bg-center"></div>
		</div>
		<div class="absolute top-0 left-1/2 -translate-x-1/2 w-96 h-96 bg-blue-500 rounded-full mix-blend-screen filter blur-3xl opacity-10 animate-blob"></div>
		<div class="absolute bottom-0 right-1/4 w-96 h-96 bg-indigo-500 rounded-full mix-blend-screen filter blur-3xl opacity-10 animate-blob" style="animation-delay: 2s;"></div>
		<div class="relative z-10 w-full max-w-md">
			<div class="mb-8 text-center">
				<img src="https://www.fabrisegurjao.adv.br/netpage/data/uploads/2019/12/logo-fabris-e-gurjao-491x325px.png" alt="Log√≥tipo Fabris e Gurj√£o" class="h-24 mx-auto mb-6 drop-shadow-lg" />
				<h1 class="text-3xl font-bold text-white mb-2">
					Sistema Financeiro
				</h1>
				<p class="text-gray-300 text-sm">
					Gest√£o profissional para advocacia
				</p>
			</div>
			<div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-8 shadow-2xl">
				<form id="login-form" class="space-y-5">
					<div>
						<label for="login-email" class="block text-sm font-medium text-gray-100 mb-2">
							Email
						</label>
						<div class="relative">
							<i class="fas fa-envelope absolute left-3 top-3.5 text-gray-400"></i>
							<input type="email"
								   id="login-email"
								   placeholder="seu@email.com"
								   class="w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
								   required />
						</div>
					</div>
					<div>
						<label for="login-password" class="block text-sm font-medium text-gray-100 mb-2">
							Senha
						</label>
						<div class="relative">
							<i class="fas fa-lock absolute left-3 top-3.5 text-gray-400"></i>
							<input type="password"
								   id="login-password"
								   placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
								   class="w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
								   required />
						</div>
					</div>
					<div id="auth-error" class="hidden p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-200 text-sm">
						<!-- O JS vai preencher o erro aqui -->
					</div>
					<button type="submit"
							id="login-submit-button"
							class="w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition duration-200 flex items-center justify-center gap-2 mt-6">
						<i id="login-button-icon" class="fas fa-sign-in-alt"></i>
						<span id="login-button-text">Entrar no Sistema</span>
					</button>
				</form>
				<div class="mt-6 text-center text-gray-400 text-xs">
					<p>Acesso restrito a utilizadores autorizados</p>
				</div>
			</div>
		</div>
	</div>
	<!-- [FIM DA TELA DE LOGIN] -->

	<!-- [REVOLU√á√ÉO] Novo layout principal com Sidebar -->
	<div id="app-container" class="flex h-screen">
		
		<!-- [REVOLU√á√ÉO] Sidebar (Desktop) -->
		<aside id="sidebar" class="hidden md:flex md:flex-col md:w-64 bg-gray-900/50 backdrop-blur-lg border-r border-gray-700/50 p-4 transition-all duration-300 z-20">
			<div class="flex-shrink-0 mb-8">
				<img src="https://www.fabrisegurjao.adv.br/netpage/data/uploads/2019/12/logo-fabris-e-gurjao-491x325px.png" alt="Log√≥tipo Fabris e Gurj√£o" class="h-20 mx-auto opacity-90" />
			</div>
			
			<nav class="flex-1 space-y-3">
				<a onclick="window.App.showPage('page-dashboard')" id="tab-dashboard" class="sidebar-nav-item active">
					<i class="fas fa-tachometer-alt w-5 text-center"></i>
					<span>Painel Principal</span>
				</a>
				<a onclick="window.App.showPage('page-inadimplentes')" id="tab-inadimplentes" class="sidebar-nav-item">
					<i class="fas fa-exclamation-triangle w-5 text-center"></i>
					<span>Inadimplentes</span>
				</a>
				<a onclick="window.App.showPage('page-servicos')" id="tab-servicos" class="sidebar-nav-item">
					<i class="fas fa-tasks w-5 text-center"></i>
					<span>Servi√ßos</span>
				</a>
				<a onclick="window.App.showPage('page-lixeira')" id="tab-lixeira" class="sidebar-nav-item">
					<i class="fas fa-trash-alt w-5 text-center"></i>
					<span>Lixeira</span>
				</a>
				<!-- [MUDAN√áA v4] Bot√£o de Notifica√ß√µes (Visual) -->
				<a onclick="window.App.showPage('page-notifications')" id="tab-notifications" class="sidebar-nav-item relative">
					<i class="fas fa-bell w-5 text-center"></i>
					<span>Notifica√ß√µes</span>
					<span id="notification-dot" class="absolute top-3 right-3 w-3 h-3 bg-red-500 rounded-full border-2 border-gray-900 hidden"></span>
				</a>
			</nav>

			<div class="mt-auto flex-shrink-0 border-t border-gray-700 pt-4">
				<div class="flex items-center gap-3 p-2 rounded-lg">
					<div class="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center font-bold text-white">
						<i class="fas fa-user"></i>
					</div>
					<div>
						<span id="user-display-name" class="text-sm text-gray-200 font-medium block"></span>
						<button id="logout-button" class="text-xs text-red-400 hover:text-red-300 transition-colors">Sair</button>
					</div>
				</div>
			</div>
		</aside>

		<!-- [REVOLU√á√ÉO] Conte√∫do Principal (com scroll pr√≥prio) -->
		<main id="main-content" class="flex-1 flex flex-col h-screen overflow-y-auto pb-24 md:pb-0">
			
			<!-- [REVOLU√á√ÉO] Cabe√ßalho do Conte√∫do (Limpo) -->
			<header class="sticky top-0 bg-gray-900/30 backdrop-blur-md border-b border-gray-700/50 p-4 z-10 md:p-6">
				<div class="flex justify-between items-center">
					<h1 id="page-title" class="text-2xl md:text-3xl font-bold text-white">Painel Principal</h1>
					<button id="mobile-menu-toggle" class="md:hidden p-2 text-gray-300 hover:text-white">
						<i class="fas fa-bars text-xl"></i>
					</button>
				</div>
			</header>

			<!-- O wrapper para as p√°ginas -->
			<div class="p-4 md:p-8 flex-1">
				<div id="page-dashboard">
					<div class="flex flex-wrap gap-4 mb-8">
						<!-- [REFINAMENTO] Bot√µes com gradiente, sombra e transi√ß√£o -->
						<button onclick="window.App.openContractModal()" class="bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white font-bold py-2 px-5 rounded-lg shadow-lg transition-all duration-200 transform hover:shadow-xl hover:-translate-y-0.5 flex items-center gap-2">
							<i class="fas fa-plus-circle"></i> Novo Contrato
						</button>
						<button onclick="window.App.openReportModal()" class="admin-only bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 text-white font-bold py-2 px-5 rounded-lg shadow-lg transition-all duration-200 transform hover:shadow-xl hover:-translate-y-0.5 flex items-center gap-2">
							<i class="fas fa-chart-line"></i> Relat√≥rio Mensal
						</button>
					</div>

					<!-- [MUDAN√áA v4] Stats do Painel de volta para 4 colunas -->
					<div id="dashboard" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
						<div class="dark-card p-6 rounded-lg shadow-lg admin-only transition-all duration-200 hover:-translate-y-1 hover:shadow-xl">
							<h3 class="text-lg font-semibold text-gray-400">A Receber (Pr√≥x. 30 dias)</h3>
							<p id="dash-a-receber" class="text-3xl font-bold text-green-400"></p>
						</div>
						<div class="dark-card p-6 rounded-lg shadow-lg admin-only transition-all duration-200 hover:-translate-y-1 hover:shadow-xl">
							<h3 class="text-lg font-semibold text-gray-400">Vencido (Corrigido)</h3>
							<p id="dash-vencido" class="text-3xl font-bold text-red-400"></p>
						</div>
						<div class="dark-card p-6 rounded-lg shadow-lg admin-only transition-all duration-200 hover:-translate-y-1 hover:shadow-xl">
							<h3 class="text-lg font-semibold text-gray-400">Recebido (Este M√™s)</h3>
							<p id="dash-recebido" class="text-3xl font-bold text-indigo-400"></p>
						</div>
						<!-- [MUDAN√áA v4] Cart√£o de "Contratos Ativos" de volta -->
						<div class="dark-card p-6 rounded-lg shadow-lg transition-all duration-200 hover:-translate-y-1 hover:shadow-xl">
							<h3 class="text-lg font-semibold text-gray-400">Meus Contratos Ativos</h3>
							<p id="dash-contratos" class="text-3xl font-bold text-white"></p>
						</div>
					</div>
					
					<div class="mb-4 border-b border-gray-700">
						<h2 class="text-2xl font-semibold mb-4 text-white">Situa√ß√£o das Parcelas (Meus Contratos)</h2>
					</div>

					<!-- [MUDAN√áA v3] Kanban agora com 3 colunas, sem scroll (em grid) -->
					<div id="kanban-board" class="grid grid-cols-1 md:grid-cols-3 gap-6 pb-4">
						<div class="kanban-column dark-card shadow-lg rounded-lg p-4 flex-1">
							<h3 class="font-bold text-lg mb-4 text-red-400 flex items-center gap-2"><i class="fas fa-exclamation-triangle"></i>Vencidas</h3>
							<div id="kanban-vencidas" class="kanban-content space-y-3"></div>
						</div>
						<div class="kanban-column dark-card shadow-lg rounded-lg p-4 flex-1">
							<h3 class="font-bold text-lg mb-4 text-yellow-400 flex items-center gap-2"><i class="far fa-clock"></i>A Vencer (Pr√≥x. 30 dias)</h3>
							<div id="kanban-a-vencer" class="kanban-content space-y-3"></div>
						</div>
						<div class="kanban-column dark-card shadow-lg rounded-lg p-4 flex-1">
							<h3 class="font-bold text-lg mb-4 text-gray-400 flex items-center gap-2"><i class="fas fa-check-circle"></i>Pagas (Este M√™s)</h3>
							<div id="kanban-pagas" class="kanban-content space-y-3"></div>
						</div>
					</div>

					<!-- [MUDAN√áA v3] Nova sec√ß√£o dedicada para √äxito -->
					<div id="exito-section" class="mt-12">
						<div class="mb-4 border-b border-gray-700">
							<h2 class="text-2xl font-semibold mb-4 text-white">Bonifica√ß√µes de √äxito Pendentes</h2>
						</div>
						<!-- Esta sec√ß√£o tem scroll horizontal se houver muitos cart√µes -->
						<div id="kanban-exito-wrapper" class="flex overflow-x-auto space-x-6 pb-4">
							<!-- [MUDAN√áA v4] Corre√ß√£o: O 'kanban-exito' √© o wrapper flex, os cart√µes s√£o adicionados diretamente aqui -->
							<div id="kanban-exito" class="flex space-x-6"></div>
						</div>
					</div>

					<div class="mt-12">
						<div class="flex flex-wrap justify-between items-center mb-4 border-b border-gray-700 pb-4 gap-4">
							<h2 class="text-2xl font-semibold text-white">Meus Contratos</h2>
							<div class="flex flex-wrap items-center gap-4">
								<button onclick="window.App.exportContractsCSV()" class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-2 px-3 rounded-lg shadow-lg transition-all duration-200 transform hover:shadow-xl hover:-translate-y-0.5 flex items-center gap-2 text-sm">
									<i class="fas fa-file-csv"></i> Exportar (CSV)
								</button>
								<select id="advogadoFilter" onchange="window.App.resetAndRenderContractList()" class="filter-select admin-only focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/50"></select>
								
								<!-- [MUDAN√áA v4] Novo Filtro Ativos/Conclu√≠dos -->
								<div class="flex items-center gap-2">
									<span class="text-sm text-gray-400">Mostrar:</span>
									<div id="contractStatusFilterButtons" class="flex gap-1">
										<!-- Bot√µes ser√£o gerados pelo JS -->
									</div>
								</div>

								<div class="flex items-center gap-2">
									<span class="text-sm text-gray-400">Ordenar por:</span>
									<div id="contractSortButtons" class="flex gap-1"></div>
								</div>
							</div>
						</div>
						<div class="mb-4">
							<input type="text" id="searchInput" placeholder="üîé Pesquisar por cliente ou tipo de servi√ßo..." class="w-full p-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200">
						</div>
						<div id="contractListContainer"></div>
						
						<div id="paginationContainer" class="flex justify-center items-center gap-2 mt-8">
						</div>
					</div>
				</div>

				<div id="page-inadimplentes" class="hidden">
					<div class="flex flex-wrap justify-between items-center mb-4 gap-4">
						<h2 class="text-2xl font-semibold text-white">Controlo de Inadimplentes (Meus Contratos)</h2>
						<div class="flex items-center gap-2">
							<span class="text-sm text-gray-400">Ordenar por:</span>
							<div id="inadimplentesSortButtons" class="flex gap-1"></div>
						</div>
					</div>
					<div id="inadimplentesListContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
				</div>

				<div id="page-servicos" class="hidden">
					<div class="flex flex-wrap justify-between items-center mb-4 gap-4">
						<h2 class="text-2xl font-semibold text-white">Controlo de Produ√ß√£o de Servi√ßos (Meus Contratos)</h2>
						<div class="flex flex-wrap items-center gap-4">
							<select id="servicosAdvogadoFilter" onchange="window.App.renderServicosPage()" class="filter-select admin-only focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/50"></select>
							<div class="flex items-center gap-2">
								<span class="text-sm text-gray-400">Ordenar por:</span>
								<div id="servicosSortButtons" class="flex gap-1"></div>
							</div>
							<input type="text" id="servicosSearchInput" placeholder="üîé Pesquisar..." class="w-full md:w-auto p-2 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200">
						</div>
					</div>
					<div id="servicosListContainer" class="space-y-8"></div>
				</div>

				<div id="page-lixeira" class="hidden">
					<div class="flex justify-between items-center mb-4">
						<h2 class="text-2xl font-semibold text-white">Lixeira de Contratos</h2>
					</div>
					<p class="text-gray-400 mb-6">Contratos exclu√≠dos s√£o mantidos aqui. Pode restaur√°-los ou exclu√≠-los permanentemente (apenas admins).</p>
					<div id="lixeiraListContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
				</div>
				
				<!-- [MUDAN√áA v4] Nova p√°gina de Notifica√ß√µes -->
				<div id="page-notifications" class="hidden">
					<h2 class="text-2xl font-semibold text-white mb-6">Notifica√ß√µes</h2>
					<div id="notificationsListContainer" class="space-y-4 max-w-2xl mx-auto">
						<!-- JS vai preencher aqui -->
						<p class="text-gray-400 text-center">Ainda n√£o h√° notifica√ß√µes.</p>
					</div>
				</div>

			</div> <!-- Fim do wrapper da p√°gina -->

		</main> <!-- Fim do <main id="main-content"> -->

		<!-- [REVOLU√á√ÉO] Navbar Mobile (Fica no fundo em ecr√£s pequenos) -->
		<nav id="mobile-nav" class="md:hidden fixed bottom-0 left-0 right-0 bg-gray-900/80 backdrop-blur-lg border-t border-gray-700/50 flex justify-around z-30">
			<a onclick="window.App.showPage('page-dashboard')" id="mobile-tab-dashboard" class="mobile-nav-item active">
				<i class="fas fa-tachometer-alt text-xl"></i>
				<span class="text-xs mt-1">Painel</span>
			</a>
			<a onclick="window.App.showPage('page-inadimplentes')" id="mobile-tab-inadimplentes" class="mobile-nav-item">
				<i class="fas fa-exclamation-triangle text-xl"></i>
				<span class="text-xs mt-1">Pendentes</span>
			</a>
			<a onclick="window.App.showPage('page-servicos')" id="mobile-tab-servicos" class="mobile-nav-item">
				<i class="fas fa-tasks text-xl"></i>
				<span class="text-xs mt-1">Servi√ßos</span>
			</a>
			<!-- [MUDAN√áA v4] Bot√£o de Notifica√ß√µes Mobile -->
			<a onclick="window.App.showPage('page-notifications')" id="mobile-tab-notifications" class="mobile-nav-item relative">
				<i class="fas fa-bell text-xl"></i>
				<span class="text-xs mt-1">Avisos</span>
				<span id="mobile-notification-dot" class="absolute top-2 right-1/4 w-3 h-3 bg-red-500 rounded-full border-2 border-gray-900 hidden"></span>
			</a>
			<a onclick="window.App.showPage('page-lixeira')" id="mobile-tab-lixeira" class="mobile-nav-item">
				<i class="fas fa-trash-alt text-xl"></i>
				<span class="text-xs mt-1">Lixeira</span>
			</a>
		</nav>

	</div> <!-- Fim do <div id="app-container"> -->

	<!-- [MUDAN√áA ARIA]: role, aria-modal, aria-labelledby -->
	<div id="modalDisplayName" class="modal bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/3 overflow-hidden" role="dialog" aria-modal="true" aria-labelledby="modalDisplayNameTitle">
		<!-- [REFINAMENTO] Cabe√ßalho do Modal -->
		<div class="p-5 bg-gray-900/50 border-b border-gray-700">
			<h2 id="modalDisplayNameTitle" class="text-2xl font-bold text-white">Bem-vindo(a)!</h2>
		</div>
		
		<!-- Corpo do Modal -->
		<div class="p-6 modal-body">
			<p class="text-gray-400 mb-4">Percebemos que √© o seu primeiro acesso. Como gostaria de ser chamado(a)?</p>
			<form id="formDisplayName">
				<div class="mb-4">
					<label for="inputDisplayName" class="block text-sm font-medium text-gray-400 mb-2">O seu Nome de Exibi√ß√£o</label>
					<!-- [REFINAMENTO] Input com novo estilo -->
					<input type="text" id="inputDisplayName" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200" required>
				</div>
				<!-- [REFINAMENTO] Bot√£o com gradiente -->
				<button type="submit" class="w-full bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">Guardar e Entrar</button>
			</form>
		</div>
	</div>

	<!-- [MUDAN√áA ARIA]: role, aria-modal, aria-labelledby -->
	<div id="modalContrato" class="modal bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-2/5 overflow-hidden flex flex-col" role="dialog" aria-modal="true" aria-labelledby="modalContratoTitle">
		<!-- [REFINAMENTO] Cabe√ßalho do Modal -->
		<div class="flex-shrink-0 flex justify-between items-center p-5 bg-gray-900/50 border-b border-gray-700">
			<h2 id="modalContratoTitle" class="text-2xl font-bold text-white">Registar Novo Contrato</h2>
			<button onclick="window.App.closeModal('modalContrato')" class="text-gray-400 hover:text-white text-2xl transition-colors duration-150" aria-label="Fechar modal">&times;</button>
		</div>
		
		<form id="formContrato" class="flex flex-col flex-1 overflow-hidden">
			<!-- [MUDAN√áA v4] Datalist para Autocomplete -->
			<datalist id="client-names-list"></datalist>
			
			<!-- Corpo do Modal (com scroll) -->
			<div class="p-6 space-y-4 overflow-y-auto modal-body">
				<input type="hidden" id="contractId">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<div>
						<label for="clienteNome" class="block text-sm font-medium text-gray-400 mb-1">Nome do Cliente</label>
						<!-- [MUDAN√áA v4] Adicionado list="client-names-list" -->
						<input type="text" id="clienteNome" list="client-names-list" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200" required>
					</div>
					<div>
						<label for="advogadoResponsavel" class="block text-sm font-medium text-gray-400 mb-1">Advogado Respons√°vel</label>
						<select id="advogadoResponsavel" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200" required></select>
					</div>
				</div>
				<div>
					<label class="block text-sm font-medium text-gray-400 mb-1">Adicionar Servi√ßos</label>
					<div id="servicosContainerWrapper" class="mt-1 p-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm">
						<div id="servicosContainer" class="flex flex-wrap items-center gap-1 w-full mb-2">
							<!-- Tags de servi√ßo entram aqui -->
						</div>
						<div class="flex gap-2">
							<input type="text" id="contratoServicoInput" class="flex-grow outline-none bg-gray-700 border border-gray-600 rounded-md px-3 py-2 text-white" placeholder="Nome do Servi√ßo...">
							<input type="date" id="contratoPrazoInput" class="bg-gray-700 border border-gray-600 rounded-md shadow-sm text-gray-400 px-3 py-2" style="color-scheme: dark;">
							<button type="button" id="addServiceButton" class="bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-bold py-2 px-3 rounded-lg">Adicionar</button>
						</div>
					</div>
				</div>
				<div>
					<label for="contratoTipoPagamento" class="block text-sm font-medium text-gray-400 mb-1">Modalidade de Pagamento</label>
					<select id="contratoTipoPagamento" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200">
						<option>Parcelado</option>
						<option>Pr√≥-labore</option>
						<option>Entrada √∫nica</option>
					</select>
				</div>
				<div>
					<label for="contratoObservacoes" class="block text-sm font-medium text-gray-400 mb-1">Observa√ß√µes</label>
					<textarea id="contratoObservacoes" rows="3" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200" placeholder="Detalhes da negocia√ß√£o, informa√ß√µes do caso, etc..."></textarea>
				</div>
				
				<div class="admin-only space-y-4">
					<h3 class="text-lg font-semibold mb-2 border-t border-gray-700 pt-4 text-white">Detalhes Financeiros</h3>
					
					<div class="p-3 bg-gray-900/50 rounded-lg border border-gray-700">
						<label for="contratoJaQuitado" class="flex items-center">
							<input type="checkbox" id="contratoJaQuitado" class="h-4 w-4 bg-gray-700 border-gray-600 rounded text-indigo-600 focus:ring-indigo-500">
							<span class="ml-2 text-sm font-medium text-gray-300">Marcar valor fixo como j√° quitado (contrato antigo)</span>
						</label>
						<p class="text-xs text-gray-500 ml-6 mt-1">Isto criar√° 1 parcela √∫nica j√° "Paga" com o Valor Total. Deixe o N¬∞ de Parcelas como 1.</p>
					</div>
					<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
						<div>
							<label for="valorTotal" class="block text-sm font-medium text-gray-400 mb-1">Valor Fixo Total (R$)</label>
							<input type="number" step="0.01" id="valorTotal" placeholder="0 se for s√≥ √™xito" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm text-white transition-all duration-200">
						</div>
						<div>
							<label for="numParcelas" class="block text-sm font-medium text-gray-400 mb-1">N¬∞ de Parcelas</label>
							<input type="number" id="numParcelas" placeholder="1 para '√Ä Vista'" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm text-white transition-all duration-200" value="1">
						</div>
					</div>
					<div>
						<label for="vencimentoPrimeiraParcela" class="block text-sm font-medium text-gray-400 mb-1">Vencimento da 1¬™ Parcela</label>
						<input type="date" id="vencimentoPrimeiraParcela" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm text-white transition-all duration-200" style="color-scheme: dark;">
					</div>
					<div>
						<label for="taxaExito" class="block text-sm font-medium text-gray-400 mb-1">Taxa de √äxito (Bonifica√ß√£o)</label>
						<input type="text" id="taxaExito" placeholder="Ex: 20%, 10000, 5 SALARIOS" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm text-white transition-all duration-200">
					</div>
				</div>
			</div>

			<!-- [REFINAMENTO] Rodap√© do Modal -->
			<div class="flex-shrink-0 flex justify-end p-4 bg-gray-900/50 border-t border-gray-700">
				<button type="button" onclick="window.App.closeModal('modalContrato')" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg mr-2 transition-all duration-200">Cancelar</button>
				<button type="submit" class="bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">Guardar</button>
			</div>
		</form>
	</div>

	<!-- [MUDAN√áA ARIA]: role, aria-modal, aria-labelledby -->
	<div id="modalPagamento" class="modal bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/3 overflow-hidden" role="dialog" aria-modal="true" aria-labelledby="modalPagamentoTitle">
		<!-- [REFINAMENTO] Cabe√ßalho do Modal -->
		<div class="flex justify-between items-center p-5 bg-gray-900/50 border-b border-gray-700">
			<h2 id="modalPagamentoTitle" class="text-2xl font-bold text-white">Registar Pagamento</h2>
			<button onclick="window.App.closeModal('modalPagamento')" class="text-gray-400 hover:text-white text-2xl transition-colors duration-150" aria-label="Fechar modal">&times;</button>
		</div>
		
		<form id="formPagamento">
			<!-- Corpo do Modal -->
			<div class="p-6 space-y-4 modal-body">
				<div id="pagamentoInfo" class="mb-4 bg-gray-700 p-3 rounded-md text-white"></div>
				<div>
					<label for="pagamentoValor" class="block text-sm font-medium text-gray-400 mb-1">Valor Pago (R$)</label>
					<input type="number" step="0.01" id="pagamentoValor" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-white transition-all duration-200" required>
				</div>
				<div>
					<label for="pagamentoData" class="block text-sm font-medium text-gray-400 mb-1">Data do Pagamento</label>
					<input type="date" id="pagamentoData" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md text-white transition-all duration-200" required style="color-scheme: dark;">
				</div>
				<input type="hidden" id="pagamentoContractId">
				<input type="hidden" id="pagamentoParcelIndex">
			</div>
			
			<!-- [REFINAMENTO] Rodap√© do Modal -->
			<div class="flex justify-end p-4 bg-gray-900/50 border-t border-gray-700">
				<button type="button" onclick="window.App.closeModal('modalPagamento')" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg mr-2 transition-all duration-200">Cancelar</button>
				<button type="submit" class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">Confirmar Pagamento</button>
			</div>
		</form>
	</div>

	<!-- [MUDAN√áA ARIA]: role, aria-modal, aria-labelledby -->
	<div id="modalCliente" class="modal bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-3/4 lg:w-2/3 overflow-hidden flex flex-col" role="dialog" aria-modal="true" aria-labelledby="clienteModalTitle">
		<!-- [REFINAMENTO] Cabe√ßalho do Modal -->
		<div class="flex-shrink-0 flex justify-between items-center p-5 bg-gray-900/50 border-b border-gray-700">
			<h2 id="clienteModalTitle" class="text-2xl font-bold text-white"></h2>
			<button onclick="window.App.closeModal('modalCliente')" class="text-gray-400 hover:text-white text-2xl transition-colors duration-150" aria-label="Fechar modal">&times;</button>
		</div>
		<!-- Corpo do Modal (com scroll) -->
		<div id="clienteModalContent" class="p-6 space-y-6 overflow-y-auto modal-body"></div>
	</div>

	<!-- [MUDAN√áA ARIA]: role, aria-modal, aria-labelledby -->
	<div id="modalRelatorio" class="modal bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-3/4 lg:w-2/3 admin-only overflow-hidden flex flex-col" role="dialog" aria-modal="true" aria-labelledby="modalRelatorioTitle">
		<!-- [REFINAMENTO] Cabe√ßalho do Modal -->
		<div class="flex-shrink-0 flex justify-between items-center p-5 bg-gray-900/50 border-b border-gray-700">
			<h2 id="modalRelatorioTitle" class="text-2xl font-bold text-white">Relat√≥rio e An√°lise</h2>
			<button onclick="window.App.closeModal('modalRelatorio')" class="text-gray-400 hover:text-white text-2xl transition-colors duration-150" aria-label="Fechar modal">&times;</button>
		</div>
		
		<!-- Corpo do Modal (com scroll) -->
		<div class="p-6 overflow-y-auto modal-body">
			<div class="flex gap-4 mb-4">
				<div class="flex-1">
					<label for="reportMonth" class="block text-sm font-medium text-gray-400 mb-1">M√™s</label>
					<select id="reportMonth" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200"></select>
				</div>
				<div class="flex-1">
					<label for="reportYear" class="block text-sm font-medium text-gray-400 mb-1">Ano</label>
					<select id="reportYear" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 text-white transition-all duration-200"></select>
				</div>
			</div>
			<div class="flex gap-4 mb-6">
				<button onclick="window.App.generateAndShowReport()" class="flex-1 bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">
					<i class="fas fa-file-invoice-dollar mr-2"></i> Relat√≥rio
				</button>
				<button onclick="window.App.showAnalyticsInModal()" class="flex-1 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">
					<i class="fas fa-chart-bar mr-2"></i> Gr√°ficos
				</button>
				<button onclick="window.App.exportReportCSV()" class="flex-1 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">
					<i class="fas fa-file-csv mr-2"></i> Exportar (CSV)
				</button>
			</div>

			<div id="reportResult" class="space-y-4">
				<!-- O JS preenche aqui -->
			</div>

			<div id="reportChartsContainer" class="hidden space-y-8">
				<div class="dark-card shadow-lg p-6 rounded-lg">
					<h3 class="text-lg font-semibold text-gray-300 mb-4">Fatura√ß√£o Real (√öltimos 12 Meses)</h3>
					<div class="relative" style="height: 350px;">
						<canvas id="actualIncomeChartModal"></canvas>
					</div>
				</div>
				<div class="dark-card shadow-lg p-6 rounded-lg">
					<h3 class="text-lg font-semibold text-gray-300 mb-4">Proje√ß√£o de Ganhos (Pr√≥ximos 12 Meses)</h3>
					<p class="text-sm text-gray-400 mb-4 -mt-3">(Baseado em parcelas pendentes)</p>
					<div class="relative" style="height: 350px;">
						<canvas id="projectedIncomeChartModal"></canvas>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- [MUDAN√áA ARIA]: role, aria-modal, aria-labelledby -->
	<div id="modalExito" class="modal bg-gray-800 rounded-lg shadow-xl w-11/12 md:w-1/3 overflow-hidden" role="dialog" aria-modal="true" aria-labelledby="modalExitoTitle">
		<!-- [REFINAMENTO] Cabe√ßalho do Modal -->
		<div class="flex-shrink-0 flex justify-between items-center p-5 bg-gray-900/50 border-b border-gray-700">
			<h2 id="modalExitoTitle" class="text-2xl font-bold text-white">Registar Recebimento de √äxito</h2>
			<button onclick="window.App.closeModal('modalExito')" class="text-gray-400 hover:text-white text-2xl transition-colors duration-150" aria-label="Fechar modal">&times;</button>
		</div>
		
		<form id="formExito">
			<!-- Corpo do Modal -->
			<div class="p-6 space-y-4 modal-body">
				<div id="exitoInfo" class="mb-4 bg-gray-700 p-3 rounded-md"></div>
				<div class="admin-only">
					<label for="exitoValorRecebido" class="block text-sm font-medium text-gray-400 mb-1">Valor L√≠quido Recebido (R$)</label>
					<input type="number" step="0.01" id="exitoValorRecebido" class="mt-1 block w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-md shadow-sm text-white transition-all duration-200" placeholder="Ex: 9500.00" required>
				</div>
				<p class="mb-4 text-gray-400 non-admin-hidden">Confirme o recebimento do valor de √™xito.</p>
				<input type="hidden" id="exitoContractId">
			</div>

			<!-- [REFINAMENTO] Rodap√© do Modal -->
			<div class="flex-shrink-0 flex justify-end p-4 bg-gray-900/50 border-t border-gray-700">
				<button type="button" onclick="window.App.closeModal('modalExito')" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg mr-2 transition-all duration-200">Cancelar</button>
				<button type="submit" class="bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5">Guardar Recebimento</button>
			</div>
		</form>
	</div>

	<div id="modal-backdrop" class="modal-backdrop"></div>
